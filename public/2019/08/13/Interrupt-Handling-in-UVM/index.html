<!DOCTYPE html>
<html>
  <head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#33363b">
    <meta name="msapplication-TileColor" content="#33363b">
    
    
    
    
    <meta name="keywords" content="UVM, SystemVerilog/Verilog, ABV/FPV, C/C++/SystemC, Python/Perl/Shell/Tcl, 验证, IC/FPGA">
    
    
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
    
    
    <link rel="icon" type="image/png" sizes="192x192" href="/favicons/android-chrome-192x192.png">
    
    
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    
    
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
    
    
    <link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#33363b">
    
    
    <link rel="manifest" href="/favicons/site.webmanifest">
    
    
    <meta name="msapplication-config" content="/favicons/browserconfig.xml">
    
    
    <link rel="alternate" href="/atom.xml" title="验证技术博客@神秘人" type="application/atom+xml">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="/favicons/favicon.ico">
    
    
    <link rel="stylesheet" type="text/css" href="/css/normalize.css">
    <link rel="stylesheet" type="text/css" href="/css/index.css">
    
    <link rel="stylesheet" type="text/css" href="/css/sidebar.css">
    
    
<link rel="stylesheet" type="text/css" href="/css/page.css">
<link rel="stylesheet" type="text/css" href="/css/post.css">

    <link rel="stylesheet" type="text/css" href="/css/custom.css">
    <link rel="stylesheet" type="text/css" href="/css/atom-one-dark.css">
    <link rel="stylesheet" type="text/css" href="/css/lightgallery.min.css">
    <script type="text/javascript" src="/js/jquery.min.js"></script>
    <script defer type="text/javascript" src="/js/util.js"></script>
    <script defer type="text/javascript" src="/js/clipboard.min.js"></script>
    <script defer type="text/javascript" src="/js/scrollspy.js"></script>
    <script defer type="text/javascript" src="/js/fontawesome-all.min.js"></script>
    <script defer type="text/javascript" src="/js/lightgallery.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-fullscreen.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-hash.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-pager.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-thumbnail.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-zoom.min.js"></script>
    
    <script defer src="/js/busuanzi.pure.mini.js"></script>
    
    
    <script defer type="text/javascript" src="/js/search.js"></script>
    <script type="text/javascript">
    $(document).ready(function () {
      var searchPath = "search.xml";
      if (searchPath.length === 0) {
        searchPath = "search.xml";
      }
      var path = "/" + searchPath;
      searchFunc(path, "search-input", "search-result");
    });
    </script>
    
    
    
    
    <script defer type="text/javascript" src="/js/index.js"></script>
    <script type="text/javascript">
    $(document).ready(function () {
      var cb = null;
      var els = $(".post figure.highlight");
      if (els.length) {
        // Enabled Hexo highlight line number.
        $(els).each(function (i, e) {
          $(e).before("<button class=\"copy button\">复制</button>");
        });
        cb = new ClipboardJS("button.copy", {
          "target": function (trigger) {
              // Get target element by DOM API.
              // nextElementSibling is figure,highlight.
              // And following is the sequence of Hexo's internal
              // highlight layout with line number.
              return trigger.nextElementSibling.firstChild.firstChild.firstChild.lastChild.firstChild.firstChild;
          }
        });
      } else {
        // Disabled Hexo highlight line number.
        els = $(".post pre code");
        $(els).each(function (i, e) {
          // Add button before pre, not code.
          $(e).parent().before("<button class=\"copy button\">复制</button>");
        });
        cb = new ClipboardJS("button.copy", {
          "target": function (trigger) {
              // Get target element by DOM API.
              // nextElementSibling is figure,highlight.
              // And following is the sequence of Hexo's internal
              // highlight layout without line number.
              return trigger.nextElementSibling.firstChild;
          }
        });
      }
      cb.on("success", function (e) {
        e.clearSelection();
        var trigger = e.trigger;
        // Change button text as a user tip.
        trigger.innerHTML = "已复制";
        $(trigger).addClass("copied");
        // Change button text back;
        setTimeout(function () {
          trigger.innerHTML = "复制";
          $(trigger).removeClass("copied");
        }, 1500);
      });
    });
    </script>
    
    <script defer type="text/javascript" src="/js/custom.js"></script>
    <title>Interrupt Handling in UVM | 验证技术博客@神秘人 - 人的智慧不用就会枯萎。</title>
  </head>
  <body itemscope itemtype="http://schema.org/WebPage" lang="zh_CN" data-spy="scroll" data-target=".list-group">
    
<header id="header" class="header" style="background: #33363b;">
  <div class="container">
    <div class="header-container">
      <div class="header-title">
        <h1 class="title"><a href="/">验证技术博客@神秘人</a></h1>
        <h2 class="subtitle">人的智慧不用就会枯萎。</h2>
      </div>
      
      <div class="logo">
        <img src="/images/logo.png" alt="logo">
      </div>
      
    </div>
    <nav id="nav" class="nav">
      <a id="nav-toggle" class="nav-toggle" aria-hidden="true"><i class="fas fa-bars" aria-label="切换导航栏"></i></a>
      <ul id="menu" role="menubar" aria-hidden="false">
        
        <li role="menuitem"><a href="/"><i class="fas fa-home"></i><span class="menu-text">首页</span></a></li>
        
        <li role="menuitem"><a href="/archives/"><i class="fas fa-archive"></i><span class="menu-text">归档</span></a></li>
        
        <li role="menuitem"><a href="/categories/"><i class="fas fa-th-list"></i><span class="menu-text">分类</span></a></li>
        
        <li role="menuitem"><a href="/tags/"><i class="fas fa-tags"></i><span class="menu-text">标签</span></a></li>
        
        <li role="menuitem"><a href="/hyperlink/"><i class="fas fa-link"></i><span class="menu-text">链接</span></a></li>
        
        <li role="menuitem"><a href="/books"><i class="fas fa-book"></i><span class="menu-text">读书</span></a></li>
        
        <li role="menuitem"><a href="/movies"><i class="fas fa-film"></i><span class="menu-text">电影</span></a></li>
        
        <li role="menuitem"><a href="/guessbook/"><i class="fas fa-user-edit"></i><span class="menu-text">留言</span></a></li>
        
      </ul>
    </nav>
  </div>
</header>


    <main id="main" class="main">
      <div class="container">
        <div class="main-container">
          <div class="content">
            
<div id="post" class="page">
  
  <article class="article post card animate" itemscope itemtype="http://schema.org/Article">
    <div class="post-block">
      <link itemprop="mainEntityOfPage" href="http://192.154.218.26/2019/08/13/Interrupt-Handling-in-UVM/">
      <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
       <meta itemprop="name" content="神秘人">
       <meta itemprop="description" content="在人生中最艰难的是选择。">
       <meta itemprop="image" content="/images/avatar.png">
      </span>
      <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
       <meta itemprop="name" content="验证技术博客@神秘人">
      </span>
    </div>
    <header class="post-header">
      <h1 class="post-title" itemprop="name headline">Interrupt Handling in UVM</h1>
      <div class="post-meta">
         
        
        <span class="post-date">
          <i class="far fa-calendar-plus"></i><span><time title="post-date" itemprop="dateCreated datePublished" datetime="2019-08-13T09:32:37+08:00">2019-08-13 09:32:37</time></span>
        </span>
        
        
        
        <span class="post-meta-divider divider">|</span>
        
        <span class="post-categories">
          
          <i class="far fa-folder-open"></i><span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/验证/" itemprop="url" rel="index"><span itemprop="name">验证</span></a></span>
        </span>
	<span class="post-meta-item-text">  字数统计: </span>
	<span class="post-count">1.1k字</span>
	<span class="post-meta-item-text">  阅读时长: </span>
	<span class="post-count">6分</span>
	<span id="busuanzi_container_page_pv">本文总阅读量<span id="busuanzi_value_page_pv"></span>次</span>
        
        
        
        
      </div>
    </header>
    <main class="post-main" itemprop="articleBody">
      <p><strong>Interrupt handling</strong> is a well known feature of any SoC which usually comprises of CPU, Bus Fabric, several Controllers, Sub-Systems &amp; many IP blocks as part of it. In some way or other Interrupts are used to act as the sideband signals of the Design/IP Blocks &amp; most of time its not the part of main bus or control bus.</p>
<p><strong>Fundamentally, Interrupts are the events which triggers a new thread of processing.</strong> Usually Interrupt acts in a System or Sub-System environment, where Design or IP blocks generates an event once certain design conditions are met or fulfilled. These events might be expected to propagate to the CPU via Interrupt Controller. An <strong>Interrupt Controller</strong>helps to manage several interrupts from different IPs, prioritize or arbitrate these interrupts. Interrupt Controller can be configured to enable &amp; disable interrupts &amp; can accept multiple interrupt request lines.</p>
<p>Coming back to the role of Interrupts in a System – it triggers a new thread of processing. This new thread which is usually called the <strong>Interrupt Service Routine (ISR)</strong> can either take the place of current execution thread, or it can be used to wake up a sleeping process to initiate some hardware activity.</p>
<p>Now, lets see how using UVM the Interrupt Service Routine is serviced when an interrupt is asserted. The simplest way to model interrupt handling is to trigger the <strong>execution of a Sequence</strong> that uses the <strong>grab()</strong>method to get the exclusive access of the <strong>Sequencer</strong>. In this way the current stimulus generation is disrupted but this is actually what happens when an ISR is triggered on a CPU. The interrupt service routine that is represented in the form of a <strong>Sequence</strong> can not be interrupted itself, &amp; must make an <strong>ungrab()</strong> call before it completes.</p>
<p>Now lets see it through an example of UVM code below:</p>
<hr>
<figure class="hljs highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs verilog"><span class="hljs-comment">///// Top-Level Sequence</span><br><span class="hljs-keyword">class</span> top_level_seq <span class="hljs-keyword">extends</span> uvm_sequence <span class="hljs-variable">#(transaction)</span>;<br> <span class="hljs-meta">`uvm_object_utils(top_level_seq)</span><br> <br> <span class="hljs-keyword">function</span> <span class="hljs-keyword">new</span> (<span class="hljs-keyword">string</span> name);<br> <span class="hljs-keyword">super</span><span class="hljs-variable">.new</span>(name);<br> <span class="hljs-keyword">endfunction</span>: <span class="hljs-keyword">new</span><br> <br> <span class="hljs-keyword">task</span> body;<br>  <span class="hljs-comment">/// Sequence instantiation</span><br> main_seq MAIN_SEQ;<br> isr ISR;<br> <br> <span class="hljs-comment">/// Interrupt specific configuration class</span><br> int_config INT_CONF;<br> <br> MAIN_SEQ = main_seq::type_id::create(<span class="hljs-string">"MAIN_SEQ"</span>, <span class="hljs-keyword">this</span>);<br> ISR = isr::type_id::create(<span class="hljs-string">"ISR"</span>, <span class="hljs-keyword">this</span>);<br> <span class="hljs-keyword">if</span> (!uvm_config_db <span class="hljs-variable">#(int_config)::get(null, get_full_name(), "int_confir", INT_CONF))</span> <span class="hljs-keyword">begin</span><br> <span class="hljs-meta">`uvm_error("TOP SEQ BODY", "Failed to get int_config");</span><br> <span class="hljs-keyword">end</span><br> <br> <span class="hljs-comment">/// Two level of forked process</span><br> <span class="hljs-keyword">fork</span><br>   PRI_SEQ<span class="hljs-variable">.start</span>(m_sequencer);<br>    <span class="hljs-keyword">begin</span><br>     <span class="hljs-keyword">forever</span> <span class="hljs-keyword">begin</span><br>      <span class="hljs-keyword">fork</span><br>        INT_CONF<span class="hljs-variable">.wait_for_IRQ0</span>();<br>        INT_CONF<span class="hljs-variable">.wait_for_IRQ1</span>();<br>        INT_CONF<span class="hljs-variable">.wait_for_IRQ2</span>();<br>        INT_CONF<span class="hljs-variable">.wait_for_IRQ3</span>();<br>      <span class="hljs-keyword">join_any</span><br>      <span class="hljs-keyword">disable</span> <span class="hljs-keyword">fork</span>;<br>      ISR<span class="hljs-variable">.start</span>(m_sequencer)<br>    <span class="hljs-keyword">end</span><br>  <span class="hljs-keyword">end</span><br> <span class="hljs-keyword">join_any</span><br> <span class="hljs-keyword">disable</span> <span class="hljs-keyword">fork</span>;<br><span class="hljs-keyword">endtask</span>: body<br> <br><span class="hljs-keyword">endclass</span>: top_level_seq<br></code></pre></td></tr></table></figure>
<hr>
<p>This is the top level sequence i.e. <strong>top_level_seq</strong> which controls both main Sequence i.e. <strong>main_seq</strong> and Interrupt Service Routine (ISR) Sequence i.e. <strong>isr</strong>. In the main sequence a configuration class i.e. <strong>int_config</strong> is instantiated that contains the <strong>hardware synchronization tasks</strong> for the interrupts i.e. <strong>wait_for_IRQx()</strong>. To know more in detail about hardware synchronization tasks, please refer my previous post titled Wait for Interface Signals in UVM.</p>
<p>The most important piece of the main sequence is the <strong>two level forked process</strong>. <strong>In the first level</strong>, primarily two processes are spawned – The main sequence &amp; the Interrupt assertion on any one of the Interrupts out of four possibilities i.e. IRQ1-IRQ4. <strong>Second level</strong> of fork process is encapsulated in a <strong>forever</strong> loop. Once an Interrupt is sensed, other second level processes (IRQx) are disabled using <strong>disable fork</strong> and active Interrupt is serviced &amp; finally due to forever loop, all the 4 second level of processes are spawned again to poll the interrupts.</p>
<p>Once the main sequence is over, there is no point of keep running and waiting for the interrupts, hence the <strong>fork..join_any</strong> process is disabled using <strong>disable fork</strong> at the first level<strong>.</strong></p>
<p>Now lets examine the code for 2 other Sub-Sequences below:</p>
<hr>
<figure class="hljs highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><code class="hljs verilog"><span class="hljs-comment">///// Main Sequence</span><br><span class="hljs-keyword">class</span> main_seq <span class="hljs-keyword">extends</span> uvm_sequence <span class="hljs-variable">#(transaction)</span>;<br> <span class="hljs-meta">`uvm_object_utils(main_seq)</span><br>  <br> <span class="hljs-keyword">function</span> <span class="hljs-keyword">new</span> (<span class="hljs-keyword">string</span> name);<br>  <span class="hljs-keyword">super</span><span class="hljs-variable">.new</span>(name);<br> <span class="hljs-keyword">endfunction</span>: <span class="hljs-keyword">new</span><br> <br> <span class="hljs-keyword">task</span> body;<br> <br> transaction req;<br>  req = transaction::type_id::create(<span class="hljs-string">"transaction"</span>, <span class="hljs-keyword">this</span>);<br> <br> <span class="hljs-keyword">repeat</span>(<span class="hljs-number">150</span>) <span class="hljs-keyword">begin</span><br> start_item(req);<br> <span class="hljs-keyword">if</span> (!req<span class="hljs-variable">.randomize</span>() <span class="hljs-keyword">with</span> &#123;addr <span class="hljs-keyword">inside</span> &#123;[<span class="hljs-number">32'h0010_0000</span>:<span class="hljs-number">32'h0010_001C</span>]&#125;; read_not_write == <span class="hljs-number">0</span>;&#125;) <span class="hljs-keyword">begin</span><br> <span class="hljs-meta">`uvm_error("MAIN SEQ BODY", "req randomization failure")</span><br> <span class="hljs-keyword">end</span><br> finish_item();<br> <span class="hljs-keyword">end</span><br> <span class="hljs-keyword">endtask</span>: body<br> <br><span class="hljs-keyword">endclass</span>: main_seq<br><br><span class="hljs-comment">///// ISR Sequence</span><br><span class="hljs-keyword">class</span> isr <span class="hljs-keyword">extends</span> uvm_sequence <span class="hljs-variable">#(transaction)</span>;<br> <span class="hljs-meta">`uvm_object_utils(isr)</span><br> <br> <span class="hljs-keyword">function</span> <span class="hljs-keyword">new</span> (<span class="hljs-keyword">string</span> name);<br>  <span class="hljs-keyword">super</span><span class="hljs-variable">.new</span>(name);<br> <span class="hljs-keyword">endfunction</span>: <span class="hljs-keyword">new</span><br> <br> <span class="hljs-comment">/// Request data</span><br> <span class="hljs-keyword">rand</span> <span class="hljs-keyword">logic</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] addr;<br> <span class="hljs-keyword">rand</span> <span class="hljs-keyword">logic</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] write_data;<br> <span class="hljs-keyword">rand</span> <span class="hljs-keyword">bit</span> read_not_write;<br> <span class="hljs-keyword">rand</span> <span class="hljs-keyword">int</span> delay;<br> <span class="hljs-comment">/// Response data</span><br> <span class="hljs-keyword">bit</span> error;<br> <span class="hljs-keyword">logic</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] read_data<br> <br> <span class="hljs-keyword">task</span> body;<br> transaction req;<br> <br> <span class="hljs-comment">/// Grabbing the sequencer</span><br> m_sequencer<span class="hljs-variable">.grab</span>(<span class="hljs-keyword">this</span>);<br> <br> req = transaction::type_id::create(<span class="hljs-string">"transaction"</span>, <span class="hljs-keyword">this</span>);<br> <br> <span class="hljs-comment">///Read from the status register to determine the cause of interrupt</span><br> <span class="hljs-keyword">if</span>(!req<span class="hljs-variable">.randomize</span>() <span class="hljs-keyword">with</span> &#123;addr == <span class="hljs-number">32</span>'<span class="hljs-number">0010_0000</span>; read_not_write == <span class="hljs-number">1</span>;&#125;) <span class="hljs-keyword">begin</span><br> <span class="hljs-meta">`uvm_error("INT SEQ BODY", "randomization failure")</span><br> <span class="hljs-keyword">end</span><br> start_item(req);<br> finish_item(req);<br> <br> <span class="hljs-comment">/// Clear the IRQ bit</span><br> req<span class="hljs-variable">.read_not_write</span> = <span class="hljs-number">0</span>;<br> <span class="hljs-keyword">if</span>(req<span class="hljs-variable">.read_data</span>[<span class="hljs-number">0</span>] == <span class="hljs-number">1</span>)<br> <span class="hljs-keyword">begin</span><br> <span class="hljs-meta">`uvm_info("ISR SEQ BODY", "IRQ[0] detected", UVM_LOW)</span><br> req<span class="hljs-variable">.write_data</span>[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;<br> start_item(req);<br> finish_item(req);<br> <span class="hljs-meta">`uvm_info("ISR SEQ BODY", "IRQ[0] cleared", UVM_LOW)</span><br> <span class="hljs-keyword">end</span><br> <br> <span class="hljs-keyword">if</span>(req<span class="hljs-variable">.read_data</span>[<span class="hljs-number">1</span>] == <span class="hljs-number">1</span>)<br> <span class="hljs-keyword">begin</span><br> <span class="hljs-meta">`uvm_info("ISR SEQ BODY", "IRQ[1] detected", UVM_LOW)</span><br> req<span class="hljs-variable">.write_data</span>[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br> start_item(req);<br> finish_item(req);<br> <span class="hljs-meta">`uvm_info("ISR SEQ BODY", "IRQ[1] cleared", UVM_LOW)</span><br> <span class="hljs-keyword">end</span><br> <br> <span class="hljs-keyword">if</span>(req<span class="hljs-variable">.read_data</span>[<span class="hljs-number">2</span>] == <span class="hljs-number">1</span>)<br> <span class="hljs-keyword">begin</span><br> <span class="hljs-meta">`uvm_info("ISR SEQ BODY", "IRQ[2] detected", UVM_LOW)</span><br> req<span class="hljs-variable">.write_data</span>[<span class="hljs-number">2</span>] = <span class="hljs-number">0</span>;<br> start_item(req);<br> finish_item(req);<br> <span class="hljs-meta">`uvm_info("ISR SEQ BODY", "IRQ[2] cleared", UVM_LOW)</span><br> <span class="hljs-keyword">end</span><br> <br> <span class="hljs-keyword">if</span>(req<span class="hljs-variable">.read_data</span>[<span class="hljs-number">3</span>] == <span class="hljs-number">1</span>)<br> <span class="hljs-keyword">begin</span><br> <span class="hljs-meta">`uvm_info("ISR SEQ BODY", "IRQ[3] detected", UVM_LOW)</span><br> req<span class="hljs-variable">.write_data</span>[<span class="hljs-number">3</span>] = <span class="hljs-number">0</span>;<br> start_item(req);<br> finish_item(req);<br> <span class="hljs-meta">`uvm_info("ISR SEQ BODY", "IRQ[3] cleared", UVM_LOW)</span><br> <span class="hljs-keyword">end</span><br> <span class="hljs-comment">/// Processing the transaction with interrupt line low</span><br> start_item(req);<br> finish_item(req);<br> <br> <span class="hljs-comment">/// Releasing the Sequencer for the main Sequence</span><br> m_sequencer<span class="hljs-variable">.ungrab</span>(<span class="hljs-keyword">this</span>);<br> <br> <span class="hljs-keyword">endtask</span>: body<br> <br><span class="hljs-keyword">endclass</span>: isr<br></code></pre></td></tr></table></figure>
<hr>
<p>In the above UVM code, the main sequence i.e. <strong>main_seq</strong> is pretty straight forward. It is implementing a loop (150 times) in which the <strong>transaction</strong> i.e. <strong>req</strong> is sent to the <strong>UVM Driver</strong> &amp; finally to the <strong>bus interface</strong> for that many times.</p>
<p><strong>Important</strong> thing to observe in the Interrupt Service Routine (ISR) Sequence i.e. <strong>isr</strong> is the use of <strong>grab()</strong> and <strong>ungrab()</strong> tasks. Another important thing to notice is the <strong>interrupt priority structure</strong>. The written order is important and top entry in IRQ[1]-IRQ[4] i.e. IRQ[1] is serviced first. Other key functional information is provided in the form of comments along with the code, please refer that. Using the grab(), <strong>isr</strong>Sequence takes full control of the Sequencer and perform the defined tasks of the ISR and later once done using ungrab() call, it releases the Sequencer for the main Sequence to continue.</p>

    </main>
    <footer class="post-footer">
      
      <div class="post-tags">
        
        <a class="post-tag button" href="/tags/UVM/" rel="tag"><i class="fas fa-tags"></i>UVM</a>
        
        <a class="post-tag button" href="/tags/SystemVerilog/" rel="tag"><i class="fas fa-tags"></i>SystemVerilog</a>
        
      </div>
      
    </footer>
  </article>
  <footer class="post-footer"> 
	<div>    
	
	
	<ul class="post-copyright">
	<li class="post-copyright-author">
      <strong>本文作者：</strong>神秘人(275244143@qq.com)

	</li>
	<li class="post-copyright-link">
		<strong>本文链接：</strong>
		<a href="/2019/08/13/Interrupt-Handling-in-UVM/" title="Interrupt Handling in UVM">http://118.25.122.94:8080/2019/08/13/Interrupt-Handling-in-UVM/</a>
	</li>
	<li class="post-copyright-license">
		<strong>版权声明： </strong>
		转载请注明出处！
	</li>
	</ul>
	
  
  
<div class="reward" id="reward">
  <p>您的支持是我前进的动力,谢谢QQ红包支持！</p>
  <button id="reward-button" class="button" disable="enable">打赏</button>
  <div id="qr" class="qr" style="display: none;" aria-hidden="true">
    
    <div id="wechat">
      <img id="wechat_qr" src="/images/WeChatPay.png" alt="微信支付">
      <span>微信支付</span>
    </div>
    
    
    
  </div>
</div>


  
  
  <nav class="page-nav">
    <div class="page-nav-next page-nav-item">
      
      <a href="/2019/08/13/How-to-handle-Reset-in-UVM/" rel="next" title="How to handle Reset in UVM?"><i class="fas fa-angle-left"></i><span class="nav-title">How to handle Reset in UVM?</span></a>
      
    </div>
    <div class="page-nav-prev page-nav-item">
      
      <a href="/2019/08/13/Wait-for-Interface-Signals-in-UVM/" rel="prev" title="Wait for Interface Signals in UVM"><span class="nav-title">Wait for Interface Signals in UVM</span><i class="fas fa-angle-right"></i></a>
      
    </div>
  </nav>
  
 
</div>
  
  

<div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_qzone" data-cmd="qzone"></a><a href="#" class="bds_tsina" data-cmd="tsina"></a><a href="#" class="bds_tqq" data-cmd="tqq"></a><a href="#" class="bds_renren" data-cmd="renren"></a><a href="#" class="bds_weixin" data-cmd="weixin"></a></div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdPic":"","bdStyle":"0","bdSize":"16"},"share":{},"image":{"viewList":["qzone","tsina","tqq","renren","weixin"],"viewText":"分享到：","viewSize":"16"},"selectShare":{"bdContainerClass":null,"bdSelectMiniList":["qzone","tsina","tqq","renren","weixin"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?'];</script>
<div class="comments" id="comments">
  
  
  <div id="vcomments" class="vcomments"></div>
  <script defer src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script defer src="//unpkg.com/valine/dist/Valine.min.js"></script>
  <script type="text/javascript">
  $(document).ready(function () {
    new Valine({
      "el": "#vcomments",
      "appId": "W7WmsjtT2mjSRGNr37ItfPte-gzGzoHsz",
      "appKey": "PqW79xh6BY4pjdBvo4hrLOvq",
      "verify": "false",
      "notify": "false",
      "avatar": "mm",
      "meta": ["nick", "mail", "link"],
      "pageSize": 10,
      "lang": "zh-cn",
      "visitor": "false",
      "highlight": "true",
      "placeholder": "在这里说点什么……",
      "avatarForce": "false"
    });
  });
  </script>
  
  
</div>



  
</footer></div>

          </div>
          
          
          
<aside class="sidebar" id="sidebar" style="background: url(/images/background.png);">
  
  <div class="search">
    <div class="form-group">
      <i class="fas fa-search"></i><input type="search" id="search-input" name="q" results="0" placeholder="搜索" class="form-control">
    </div>
  </div>
  <div class="search-result-box" id="search-result"></div>
  
  
<div class="info sidebar-item" id="info">
  
  <img class="author-avatar" src="/images/avatar.png" alt="神秘人">
  
  <h1 class="author-name">神秘人</h1>
  <h2 class="author-description">在人生中最艰难的是选择。</h2>
  <div class="site-count">
    
    
    
    
    <div class="archives-count count-block">
      <div class="site-count-title">归档</div>
      <div><a href="/archives/">124</a></div>
    </div>
    
    
    
    <div class="categories-count count-block">
      <div class="site-count-title">分类</div>
      <div><a href="/categories/">15</a></div>
    </div>
    
    
    
    <div class="tags-count count-block">
      <div class="site-count-title">标签</div>
      <div><a href="/tags/">47</a></div>
    </div>
    
    
    
    
    
    
    
    
    
    
  </div>
  
  <div class="rss">
    <a class="rss-link button sidebar-item" href="/atom.xml"><i class="fas fa-rss"></i>RSS</a>
  </div>
  
</div>


  <div class="sidebar-sticky">
    
    
    
    
    
    
    
    <script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
    <script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
    <div class="widget-wrap">
        <h3 class="widget-title">标签云</h3>
        <div id="myCanvasContainer" class="widget tagcloud">
            <canvas width="300" height="250" id="resCanvas" style="width=100%">
                <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ABV/">ABV</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Altera/">Altera</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C-C/">C/C++</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CMake/">CMake</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Chisel/">Chisel</a><span class="tag-list-count">17</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/">Docker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/EDA/">EDA</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FV/">FV</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GLIBC/">GLIBC</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LFSR/">LFSR</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NCsim/">NCsim</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RAL/">RAL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RTL/">RTL</a><span class="tag-list-count">17</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Socket/">Socket</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Synopsys/">Synopsys</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SystemVerilog/">SystemVerilog</a><span class="tag-list-count">76</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TCP/">TCP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UVM/">UVM</a><span class="tag-list-count">67</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VCS/">VCS</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VMware/">VMware</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Verilog/">Verilog</a><span class="tag-list-count">19</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/awk/">awk</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bash/">bash</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/c-c/">c/c++</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/emacs/">emacs</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/evil/">evil</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gdb/">gdb</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/">github</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gtd/">gtd</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oh-my-zsh/">oh-my-zsh</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/org-mode/">org-mode</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/">shell</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssh/">ssh</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tig/">tig</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/">ubuntu</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vim/">vim</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xargs/">xargs</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/yaml/">yaml</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zsh/">zsh</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/并行/">并行</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/性能/">性能</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/编译器/">编译器</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/脚本/">脚本</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/音乐/">音乐</a><span class="tag-list-count">1</span></li></ul>
            </canvas>
        </div>
    </div>
    
    
    <hr>
    <div class="social-link sidebar-item">
      <div><i class="far fa-address-card"></i>社交链接<p></p></div>
      <ul>
        
        <li><i class="fas fa-envelope"></i><a href target="_blank">E-Mail(275244143@qq.com)</a></li>
        
      </ul>
    </div>
    
    
    <hr>
    <div class="blogroll sidebar-item">
      <div><i class="fas fa-link"></i>友情链接</div>
      <ul>
        
        <li><i class="fas fa-link"></i><a href target="_blank">验证公众号(IC_verification)</a></li>
        
        <li><i class="fas fa-link"></i><a href target="_blank">验证专业QQ群(231631333)</a></li>
        
      </ul>
    </div>
    
  </div>
  <script type="text/javascript" src="//ra.revolvermaps.com/0/0/6.js?i=0rv302arua5&amp;m=7&amp;c=e63100&amp;cr1=ffffff&amp;f=arial&amp;l=0&amp;bv=90&amp;lx=-420&amp;ly=420&amp;hi=20&amp;he=7&amp;hc=a8ddff&amp;rs=80" async="async"></script>
</aside>


          
        </div>
      </div>
    </main>
    
<footer id="footer" class="footer" style="background: #33363b;">
  <div class="container">
    <div class="back-to-top">
      <button id="back-to-top"><i class="fas fa-angle-double-up" aria-label="回到顶部"></i></button>
    </div>
    <div class="footer-container">
      <div class="footer-left">
        <div class="copyright">
          <span class="author">神秘人</span><span class="year"><i class="far fa-copyright"></i>2020</span>
        </div>
        
        <div class="busuanzi">
          <span id="busuanzi_container_site_pv"><i class="fas fa-eye" aria-label="站点点击量" aria-hidden="false"></i><span id="busuanzi_value_site_pv"></span></span><span id="busuanzi_container_site_uv"><i class="fas fa-user" aria-label="站点用户数" aria-hidden="false"></i><span id="busuanzi_value_site_uv"></span></span><span id="busuanzi_container_page_pv"><i class="far fa-file-alt"></i><span id="busuanzi_value_page_pv" aria-label="页面点击量" aria-hidden="false"></span></span>
        </div>
        
      </div>
      <div class="footer-right">
        <div class="custom-info">
          
          托管于<i class="fab fa-github-alt"></i><a>腾讯云</a>
          
        </div>
        <div class="powered-by">
          由 <a href="https://hexo.io/" target="_blank">神秘人</a> 强力驱动 | 主题 <a href="https://github.com/AlynxZhou/hexo-theme-aria/" target="_blank">UVM</a>
        </div>
      </div>
    </div>
  </div>
</footer>


	<!-- 页面点击小红心，在末尾添加，避免找不到 -->
    <script type="text/javascript" src="/js/love.js"></script>
  <script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>
</html>
